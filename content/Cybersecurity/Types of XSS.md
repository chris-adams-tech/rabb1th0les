---
title: Types of XSS
date: 2024-11-14
type: Technical Guide
topic: Web-Based
---

# Reflected XSS (**non-persistent/Type I**)

* User input is immediately returned by web application in an error message, search result, or any other response. 
* Data is not stored and may not even leave the browser.
# Stored XSS (**Persistent/Type II**)
* User input is stored on the target server; `database`, `message forum`, `visitor log`, `comment field`, etc.
* Data can then be retrieved from the web application without safety checks.
* The payload is stored on the victim's machine permanently, while never being sent to the server.

# DOM Based XSS (**Type 0**)
* Payload is executed by modifying the `DOM` environment. See here [[DOM Manipulation in Javascript]].



> [!info] Another way of looking at XSS....
> Additionally to the mentioned types of XSS attacks, there are a couple additional terms that can help cover the full scope of this attack vector.

# Server & Client Side XSS

### Server XSS
* Untrusted user supplied data is included in an HTTP response generated by the server. 
* Can be from the HTTP request or from a stored location

Both **Reflected Server XSS** and **Stored Server XSS** can occur in *Server XSS*.

### Client XSS
* Untrusted user supplied data is used to update the DOM with an unsafe JavaScript call.
* This can be either from `DOM` or sent by the server.

Both **Reflected Server XSS** and **Stored Server XSS** can occur in *Client XSS*.

## So how does the `DOM-Based XSS` fit into the puzzle?

### DOM-Based XSS
* Subset of **Client XSS** (data from client-side)


> [!info] Stored vs. Reflected
> Affects the likelihood of a successful attack, not the nature of vulnerability of defense

# How can you reduce the attack surface for these attacks?

### Server XSS

According to **OWASP**, the easiest and strongest defense is **Context-sensitive server side output encoding**. Here are some additional recommendations in detail: https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html

Some baseline rules to follow in relation to the **Context-sensitive server side output encoding**.

#### **Rule #0** Never Insert Trusted Data
#### **Rule #1** HTML Escape Before Inserting Untrusted Data into HTML Element Content
##### Special case for rule #1: sanitization
#### **Rule #2** Attribute Escape Before Inserting Untrusted Data into HTML Common Attributes
##### Rule #2 is for putting untrusted data into typical attribute values like width, name, value, etc.
#### **Rule #3** JavaScript Escape Before Inserting Untrusted Data into JavaScript Data Values
##### Rule #3 concerns dynamically generated JavaScript code - both script blocks and event-handler attributes.
#### **RULE #4** CSS Escape And Strictly Validate Before Inserting Untrusted Data into HTML Style Property Values
##### Rule #4 is for when you want to put untrusted data into a stylesheet or a style tag.
#### **RULE #5** - URL Escape Before Inserting Untrusted Data into HTML URL Parameter Values
##### Rule #5 is for when you want to put untrusted data into a query string of an HREF value.
#### **RULE #6** - Avoid JavaScript URLâ€™s

Check out this page for some mock scenarios showing *XSS* attacks: 


<div class="neon-line"></div>

Source: 
https://owasp.org/www-community/Types_of_Cross-Site_Scripting
https://apwt.gitbook.io/software-security/injection-attacks/000introxss/002xsscontextsensitiveoutputencoding

---
<div style="text-align: center;">
	<div class="gradient-text">ðŸ‘¾ 2024 rabb1th0les (Chris A)dams ðŸ‘¾</div> 
	ðŸŒ´â˜€Thanks for supporting my page â˜€ðŸŒ´
	<nav>
		<ul style="list-style: none; padding: 0;">
			<div style="text-align: center;">
				<li><a href="index.html">Home</a> | <a href="Contact.html">Contact</a></li>
			</div>
		</ul>
	</nav>	
</div>